CREATE TABLE "PERSON" (
  "ID" NUMBER(10) CONSTRAINT "PK_PERSON" PRIMARY KEY,
  "NAME" VARCHAR2(1000 CHAR),
  "AGE" VARCHAR2(1000 CHAR)
);

CREATE SEQUENCE "PERSON_SEQ" NOCACHE;

CREATE TRIGGER "PERSON_BI"
  BEFORE INSERT ON "PERSON"
  FOR EACH ROW
BEGIN
  IF :new."ID" IS NULL THEN
    SELECT "PERSON_SEQ".nextval INTO :new."ID" FROM DUAL;
  END IF;
END;;

CREATE TABLE "MUSICIAN" (
  "ID" NUMBER(10) CONSTRAINT "PK_MUSICIAN" PRIMARY KEY,
  "PERSON" NUMBER(10)
);

CREATE INDEX "IDX_MUSICIAN__PERSON" ON "MUSICIAN" ("PERSON");

ALTER TABLE "MUSICIAN" ADD CONSTRAINT "FK_MUSICIAN__PERSON" FOREIGN KEY ("PERSON") REFERENCES "PERSON" ("ID");

CREATE SEQUENCE "MUSICIAN_SEQ" NOCACHE;

CREATE TRIGGER "MUSICIAN_BI"
  BEFORE INSERT ON "MUSICIAN"
  FOR EACH ROW
BEGIN
  IF :new."ID" IS NULL THEN
    SELECT "MUSICIAN_SEQ".nextval INTO :new."ID" FROM DUAL;
  END IF;
END;;

CREATE TABLE "SONG" (
  "ID" NUMBER(10) CONSTRAINT "PK_SONG" PRIMARY KEY,
  "TITLE" VARCHAR2(1000 CHAR),
  "DURATION" VARCHAR2(1000 CHAR),
  "MUSICIAN" NUMBER(10) NOT NULL
);

CREATE INDEX "IDX_SONG__MUSICIAN" ON "SONG" ("MUSICIAN");

ALTER TABLE "SONG" ADD CONSTRAINT "FK_SONG__MUSICIAN" FOREIGN KEY ("MUSICIAN") REFERENCES "MUSICIAN" ("ID");

CREATE SEQUENCE "SONG_SEQ" NOCACHE;

CREATE TRIGGER "SONG_BI"
  BEFORE INSERT ON "SONG"
  FOR EACH ROW
BEGIN
  IF :new."ID" IS NULL THEN
    SELECT "SONG_SEQ".nextval INTO :new."ID" FROM DUAL;
  END IF;
END;;

CREATE TABLE "DANCE" (
  "SONGS" NUMBER(10) NOT NULL,
  "PERSONS" NUMBER(10) NOT NULL,
  CONSTRAINT "PK_DANCE" PRIMARY KEY ("SONGS", "PERSONS")
);

CREATE INDEX "IDX_DANCE__PERSONS" ON "DANCE" ("PERSONS");

ALTER TABLE "DANCE" ADD CONSTRAINT "FK_DANCE__PERSONS" FOREIGN KEY ("PERSONS") REFERENCES "PERSON" ("ID");

ALTER TABLE "DANCE" ADD CONSTRAINT "FK_DANCE__SONGS" FOREIGN KEY ("SONGS") REFERENCES "SONG" ("ID")
